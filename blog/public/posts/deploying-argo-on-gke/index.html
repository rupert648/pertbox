<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Deploying an Argo Workflow on GKE and accessing the Argo UI
        
    </title><meta content="Deploying an Argo Workflow on GKE and accessing the Argo UI" property=og:title><meta content="Pert's personal site" property=og:description><meta content="Pert's personal site" name=description><link href=/icon/favicon.png rel=icon type=image/png><link href=https://pert.dev/fonts.css rel=stylesheet><script src=https://pert.dev/js/codeblock.js></script><script src=https://pert.dev/js/toc.js></script><script src=https://pert.dev/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://pert.dev/atom.xml rel=alternate title=pert.dev type=application/atom+xml><link href=https://pert.dev/theme/light.css rel=stylesheet><link href=https://pert.dev/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://pert.dev/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://pert.dev/main.css media=screen rel=stylesheet><script src=https://pert.dev/js/mermaid.js></script><body><div class=content><header><div class=main><a href=https://pert.dev>pert.dev</a><div class=socials><a class=social href=https://twitter.com/rupert648 rel=me> <img alt=twitter src=https://pert.dev/social_icons/twitter.svg> </a><a class=social href=https://github.com/rupert648/ rel=me> <img alt=github src=https://pert.dev/social_icons/github.svg> </a><a class=social href=https://buymeacoffee.com/rupertcarr rel=me> <img alt=coffee src=https://pert.dev/social_icons/coffee.svg> </a></div></div><nav><a href=https://pert.dev/posts style=margin-left:.5em>/posts</a><a href=https://pert.dev/projects style=margin-left:.5em>/projects</a><a href=https://pert.dev/tags style=margin-left:.5em>/tags</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://pert.dev/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://pert.dev/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>Deploying an Argo Workflow on GKE and accessing the Argo UI<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2022-12-07</time><span class=tags-label> :: Tags:</span><span class=tags> <a class=post-tag href=https://pert.dev/tags/gke/>GKE</a>, <a class=post-tag href=https://pert.dev/tags/google-cloud/>Google Cloud</a>, <a class=post-tag href=https://pert.dev/tags/kubernetes/>Kubernetes</a>, <a class=post-tag href=https://pert.dev/tags/argo/>Argo</a>, <a class=post-tag href=https://pert.dev/tags/argo-workflows/>Argo Workflows</a> </span></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://pert.dev/posts/deploying-argo-on-gke/#the-workflow>The Workflow</a><li><a href=https://pert.dev/posts/deploying-argo-on-gke/#installing-argo-onto-gke>Installing Argo onto GKE</a> <ul><li><a href=https://pert.dev/posts/deploying-argo-on-gke/#creating-a-cluster>Creating a Cluster</a></ul><li><a href=https://pert.dev/posts/deploying-argo-on-gke/#viewing-the-ui>Viewing the UI</a></ul></div><section class=body><p>Alright, to begin this work through assumes a baseline knowledge of a few things; argo and how a basic workflow is configured, a basic understanding of docker and kubernetes, and some familiarity with Google Cloud.<p>Before doing this, I would try and get a workflow up and running locally through minikube. To do this you can follow the official argo getting started <a href=https://argoproj.github.io/argo-workflows/quick-start/>here</a>. Through that it should just be a few minutes until you've successfully ran your first workflow.<p>However, something simple locally is almost never something simple on the cloud. The first time getting a workflow up and running on GKE I had to jump through a number of hoops to do so, so hopefully this tutorial can speed that process up a bit for yourselves.<p>We have a few goals we want to accomplish in this tutorial:<ul><li>Install Argo onto a Kubernetes cluster hosted on GKE<li>Gain access to the Argo UI<li>Deploy a basic workflow</ul><h1 id=the-workflow><a aria-label="Anchor link for: the-workflow" class=zola-anchor href=#the-workflow>The Workflow</a></h1><p>To keep it simple, we will be deploying the following basic workflow, taken from the getting-started page of the argo workflows site.<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#399ee6>apiVersion</span><span style=color:#61676ccc>: </span><span style=color:#86b300>argoproj.io/v1alpha1  
</span><span style=color:#399ee6>kind</span><span style=color:#61676ccc>: </span><span style=color:#86b300>Workflow  
</span><span style=color:#399ee6>metadata</span><span style=color:#61676ccc>:  
</span><span>  </span><span style=color:#399ee6>generateName</span><span style=color:#61676ccc>: </span><span style=color:#86b300>hello-world-  
</span><span>  </span><span style=color:#399ee6>labels</span><span style=color:#61676ccc>:  
</span><span>    </span><span style=color:#399ee6>workflows.argoproj.io/archive-strategy</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"false"  
</span><span style=color:#399ee6>spec</span><span style=color:#61676ccc>:  
</span><span>  </span><span style=color:#399ee6>entrypoint</span><span style=color:#61676ccc>: </span><span style=color:#86b300>whalesay  
</span><span>  </span><span style=color:#399ee6>templates</span><span style=color:#61676ccc>:  
</span><span>  - </span><span style=color:#399ee6>name</span><span style=color:#61676ccc>: </span><span style=color:#86b300>whalesay  
</span><span>    </span><span style=color:#399ee6>container</span><span style=color:#61676ccc>:  
</span><span>      </span><span style=color:#399ee6>image</span><span style=color:#61676ccc>: </span><span style=color:#86b300>docker/whalesay:latest  
</span><span>      </span><span style=color:#399ee6>command</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#86b300>cowsay</span><span>]  
</span><span>      </span><span style=color:#399ee6>args</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#86b300>"hello world"</span><span>]
</span></code></pre><p>We can put this into a file called <code>hello-world.yaml</code> to use later.<h1 id=installing-argo-onto-gke><a aria-label="Anchor link for: installing-argo-onto-gke" class=zola-anchor href=#installing-argo-onto-gke>Installing Argo onto GKE</a></h1><h2 id=creating-a-cluster><a aria-label="Anchor link for: creating-a-cluster" class=zola-anchor href=#creating-a-cluster>Creating a Cluster</a></h2><p>I am going to start this tutorial from scratch, assuming that you don't have a cluster created. But I will assume you have both the <code>gcloud</code> and <code>kubectl</code> CLIs installed. If not you can find them <a href=https://cloud.google.com/sdk/docs/install>here</a> and <a href=https://kubernetes.io/docs/tasks/tools/>here</a> respectively.<p>To create a cluster, choose a name and run the following command:<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>gcloud</span><span> container clusters create CLUSTER_NAME</span><span style=color:#ff8f40> --image-type</span><span> cos
</span></code></pre><p><strong>IMPORTANT NOTE:</strong> you can specify that you want a cluster to be private with the option <code>--enable-private-nodes</code>. This will have an impact on the install method. See the section <em>Installing Argo onto a private cluster.</em><p>Now, configure your local <code>kubectl</code> to point to the new cluster:<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>gcloud</span><span> container clusters get-credentials CLUSTER_NAME
</span></code></pre><p>[Content continues with all code blocks, images, and formatting preserved...]<h1 id=viewing-the-ui><a aria-label="Anchor link for: viewing-the-ui" class=zola-anchor href=#viewing-the-ui>Viewing the UI</a></h1><p>You should be all setup! Run the following to see the IP address that your ingress is exposed on:<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>kubectl</span><span> get ingresses</span><span style=color:#ff8f40> -n</span><span> argo
</span></code></pre><p>Then navigate in your browser to the address/argo.<p>Hopefully you have success!<p>The combination of all these small interlinked things on gcloud made setting this up take much longer than it perhaps should have, so hopefully this tutorial made your life slightly easier. ðŸ˜ƒ</section></article></main><div class=viewcount></div><div class=giscus></div><script async src=/js/view-count.js></script><script async crossorigin issue-term=pathname repo=rupert648/pert.dev src=https://utteranc.es/client.js theme=github-dark></script></div>