<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Deploying a Spring Boot API to Railway using Maven and Docker
        
    </title><meta content="Deploying a Spring Boot API to Railway using Maven and Docker" property=og:title><meta content="Pert's personal site" property=og:description><meta content="Pert's personal site" name=description><link href=/icon/favicon.png rel=icon type=image/png><link href=https://pert.dev/fonts.css rel=stylesheet><script src=https://pert.dev/js/codeblock.js></script><script src=https://pert.dev/js/toc.js></script><script src=https://pert.dev/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://pert.dev/atom.xml rel=alternate title=pert.dev type=application/atom+xml><link href=https://pert.dev/theme/light.css rel=stylesheet><link href=https://pert.dev/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://pert.dev/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://pert.dev/main.css media=screen rel=stylesheet><script src=https://pert.dev/js/mermaid.js></script><body><div class=content><header><div class=main><a href=https://pert.dev>pert.dev</a><div class=socials><a class=social href=https://twitter.com/rupert648 rel=me> <img alt=twitter src=https://pert.dev/social_icons/twitter.svg> </a><a class=social href=https://github.com/rupert648/ rel=me> <img alt=github src=https://pert.dev/social_icons/github.svg> </a><a class=social href=https://buymeacoffee.com/rupertcarr rel=me> <img alt=coffee src=https://pert.dev/social_icons/coffee.svg> </a></div></div><nav><a href=https://pert.dev/posts style=margin-left:.5em>/posts</a><a href=https://pert.dev/projects style=margin-left:.5em>/projects</a><a href=https://pert.dev/tags style=margin-left:.5em>/tags</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://pert.dev/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://pert.dev/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>Deploying a Spring Boot API to Railway using Maven and Docker<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2022-09-20</time><span class=tags-label> :: Tags:</span><span class=tags> <a class=post-tag href=https://pert.dev/tags/software/>Software</a>, <a class=post-tag href=https://pert.dev/tags/java/>Java</a>, <a class=post-tag href=https://pert.dev/tags/maven/>Maven</a>, <a class=post-tag href=https://pert.dev/tags/railway/>Railway</a>, <a class=post-tag href=https://pert.dev/tags/docker/>Docker</a>, <a class=post-tag href=https://pert.dev/tags/springboot/>Springboot</a>, <a class=post-tag href=https://pert.dev/tags/spring-boot/>Spring-boot</a>, <a class=post-tag href=https://pert.dev/tags/backend/>Backend</a> </span></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://pert.dev/posts/spring-boot-railway/#getting-started>Getting Started</a> <ul><li><a href=https://pert.dev/posts/spring-boot-railway/#the-springboot-application>The Springboot Application</a><li><a href=https://pert.dev/posts/spring-boot-railway/#railway>Railway</a></ul><li><a href=https://pert.dev/posts/spring-boot-railway/#configuring-springboot-to-deploy-using-maven>Configuring SpringBoot to Deploy using Maven</a> <ul><li><a href=https://pert.dev/posts/spring-boot-railway/#the-dockerfile>The Dockerfile</a><li><a href=https://pert.dev/posts/spring-boot-railway/#expose-port-on-railway>Expose port on Railway</a></ul><li><a href=https://pert.dev/posts/spring-boot-railway/#making-it-public>Making it public</a></ul></div><section class=body><p>In this guide we will walk through how to deploy a Java Spring Boot API to railway.app, its deceptively simple to do, and with railway's use of nixpacks the speed of deployment will blow your mind.<p>This deployment takes just 5 steps to get from no-code to your very own public API service:<ol><li>Create a Springboot application and define some routes<li>Push this application to a github repo<li>Create a project on Railway.app from this github repo<li>Create a dockerfile to build and package the application and push it to the repo<li>Expose a public domain on Railway.app</ol><h1 id=getting-started><a aria-label="Anchor link for: getting-started" class=zola-anchor href=#getting-started>Getting Started</a></h1><h2 id=the-springboot-application><a aria-label="Anchor link for: the-springboot-application" class=zola-anchor href=#the-springboot-application>The Springboot Application</a></h2><p>The first thing you will need is a spring boot API that you can deploy! If you are just getting started with this, you can follow the official <a href=https://spring.io/guides/gs/spring-boot/>SpringBoot Getting Started Guide</a> to get your first project up and running.<p>My directory structure with a project titled "getyourway" looks as follows:<p><img alt="Directory Structure" src=https://cdn-images-1.medium.com/max/2000/1*m7dGC5a-wLzotnPx3g-xVQ.png><p>I created a file titled HelloController.java and put in the following code to define one route to <code>/</code>:<pre class=language-java data-lang=java style=color:#61676c;background-color:#fafafa><code class=language-java data-lang=java><span style=color:#61676ccc>@</span><span style=color:#f29718>RestController
</span><span style=color:#fa6e32>public class </span><span style=color:#399ee6>HelloController </span><span>{
</span><span>    </span><span style=color:#61676ccc>@</span><span style=color:#f29718>GetMapping</span><span>(</span><span style=color:#86b300>"/"</span><span>)
</span><span>    </span><span style=color:#fa6e32>public </span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#f29718>index</span><span>() {
</span><span>        </span><span style=color:#fa6e32>return </span><span style=color:#86b300>"Hello World!"</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>}
</span></code></pre><p>If we run the application using <code>$ mvn spring-boot:run</code> we can navigate to http://localhost:8080/hello where we can see our response.<p>Once done, be sure to <strong>push this project to your own github repository</strong>, so that we can later integrate with railway.<h2 id=railway><a aria-label="Anchor link for: railway" class=zola-anchor href=#railway>Railway</a></h2><p>To integrate this project with railway you will need to do two things:<ul><li>Create a Railway.app account<li>Connect Railway.app to your github account</ul><p>Railway will walk you through signing up. Once done, railway will greet you with this page:<p><img alt="Railway Welcome Page" src=https://cdn-images-1.medium.com/max/3798/1*J1QYzBKAKiTNdK-kGjxWWg.png><p>From here we will click <strong>Start a New Project</strong> and then <strong>Deploy from a Github Repo</strong>.<p>From this next screen, this is where we can connect and configure railway to work with our github account. So go ahead and click <strong>Configure Github App</strong>.<p>This will first ask you to add the app to your github account, then will allow you to configure the account and its permissions.<p><img alt="Github Permissions" src=https://cdn-images-1.medium.com/max/2000/1*0Pg4uVoMfq7yLXO2i-wQwg.png><p>Repository access will allow you to choose which repositories Railway can see. I chose to only select certain repositories, in which case <strong>you must select your newly created springboot repository so we can access it</strong>.<p>Now this is configured, back on Railway we can go ahead and select our github repository. Next click the <strong>Add Variables</strong> option, rather than deploying it right away — we first need to setup our repo to deploy.<h1 id=configuring-springboot-to-deploy-using-maven><a aria-label="Anchor link for: configuring-springboot-to-deploy-using-maven" class=zola-anchor href=#configuring-springboot-to-deploy-using-maven>Configuring SpringBoot to Deploy using Maven</a></h1><p>The docker file for our application involves two stages to the docker file:<ol><li>Building the jar file<li>Packaging the application</ol><h2 id=the-dockerfile><a aria-label="Anchor link for: the-dockerfile" class=zola-anchor href=#the-dockerfile>The Dockerfile</a></h2><p>In the root directory, create a Dockerfile with the following content:<pre class=language-Dockerfile data-lang=Dockerfile style=color:#61676c;background-color:#fafafa><code class=language-Dockerfile data-lang=Dockerfile><span style=color:#abb0b6;font-style:italic>#
</span><span style=color:#abb0b6;font-style:italic># Build stage
</span><span style=color:#abb0b6;font-style:italic>#
</span><span style=color:#fa6e32>FROM</span><span> maven:</span><span style=color:#399ee6>3.6.0-jdk-11-slim </span><span style=color:#fa6e32>AS </span><span>build
</span><span style=color:#fa6e32>COPY</span><span> src /home/app/src
</span><span style=color:#fa6e32>COPY</span><span> pom.xml /home/app
</span><span style=color:#fa6e32>RUN </span><span>mvn -f /home/app/pom.xml clean package
</span><span>
</span><span style=color:#abb0b6;font-style:italic>#
</span><span style=color:#abb0b6;font-style:italic># Package stage
</span><span style=color:#abb0b6;font-style:italic>#
</span><span style=color:#fa6e32>FROM</span><span> openjdk:</span><span style=color:#399ee6>11-jre-slim
</span><span style=color:#fa6e32>COPY</span><span> --from=build /home/app/target/getyourway-0.0.1-SNAPSHOT.jar /usr/local/lib/demo.jar
</span><span style=color:#fa6e32>EXPOSE </span><span>8080
</span><span style=color:#ed9366>ENTRYPOINT </span><span>[</span><span style=color:#86b300>"java"</span><span>,</span><span style=color:#86b300>"-jar"</span><span>,</span><span style=color:#86b300>"/usr/local/lib/demo.jar"</span><span>]
</span></code></pre><p><strong>NOTE:</strong> Be sure to change maven and openjdk to use the version of java you are using and generated the spring-boot application with to prevent build errors.<p>The build stage uses mvn package to create a jar file of our application from our pom.xml. The package stage then exposes a port before defining an entrypoint for our package. Don't forget to change /home/app/target/getyourway-0.0.1-SNAPSHOT.jar to match the name of your application (just the jar filename needs adjusting).<p>We expose port 8080, the default launch port for springboot, if you have modified this value at all in the config for your springboot application, change the port value here.<h2 id=expose-port-on-railway><a aria-label="Anchor link for: expose-port-on-railway" class=zola-anchor href=#expose-port-on-railway>Expose port on Railway</a></h2><p>Before we redeploy, we must let railway know which port our application should listen on. This can be done by setting the environment variable PORT in railway, as can be seen in the image below. Again this should be set to 8080 or your corresponding port.<p><img alt="Railway Port Configuration" src=https://cdn-images-1.medium.com/max/2330/1*IM_Qm9PqZfk_3mN7FCQkhA.png><p>Now this is done, <strong>push your code</strong> to the github repository.<p>Immediately Railway will spot this new push and start to redeploy this service.<p>Amazingly — thats it! Railway will immediately <strong>identify the Dockerfile</strong> in your repository, and use it to build an image which it uses to run the service.<h1 id=making-it-public><a aria-label="Anchor link for: making-it-public" class=zola-anchor href=#making-it-public>Making it public</a></h1><p>If we now go to the settings page of our Railway application we can click the <strong>Generate Domain</strong> button underneath <strong>Domains</strong> (or alternatively add your own domain), this will take a few seconds or minutes but then once your service has adjusted, follow through to this generated domain and go to <a href=https://getyourway-production.up.railway.app/>https://your-generated-project-name.up.railway.app/</a> and you should see "Hello World!" as your result!</section></article></main><div class=viewcount></div><div class=giscus></div><script async src=/js/view-count.js></script><script async crossorigin issue-term=pathname repo=rupert648/pert.dev src=https://utteranc.es/client.js theme=github-dark></script></div>